# Mastering Bitcoin
## Chương 1: Introducting
#### Bitcoin là gì?
<p>&nbsp Bitcoin là một tập các khái niệm và công nghệ tạo thành hệ sinh thái tiền kỹ thuật số. Đơn vị tiền bitcoin có thể được sử dung để lưu trữ và giao dịch với những người tham gia mạng lưới bitcoin. Người dung bitcoin  giao tiếp với người khác sử dụng giao thức của bitcoin. Ngăn xếp giao thức bitcoin, có sẵn như một phần mềm mã nguồn mở, có thể chạy trên nhiều thiết bị như laptop, smartphone, làm cho dễ dàng truy cập.</p>
<p>&nbsp Người dùng có thể giao dịch bitcoin thông qua mạng để có thể mua, bán hang, gửi tiền để mọi người, các tổ chức,... Công nghệ bitcoin dựa trên <b>mã hóa</b> và <b>chữ ký số</b> để đảm bảo an ninh trong mạng bitcoin. Bitcoin có thể mua, bán và trao đổi với các đồng tiền khác.Bitcoin là một dạng tiền hoàn hảo trên internet bởi vì nó nhanh, bảo mật và không giới hạn.</p>
<p>&nbsp  Không giống như tiền truyền thống, bitcoin hoàn toàn là ảo. Không có đồng tiền vật lý hoặc thậm chí tiền xu kĩ thuật số. Coins được áp dụng trong transactions chuyển từ người này đến người khác. Người dùng các khóa riêng bitcoin cho phép họ chứng minh giao dịch của chủ sỡ hữu trong mạng bitcoin, mở khóa giá trị để gửi và chuyển giao cho người nhận mới. Cái key này được lưu trữ trong digital wallet của mỗi máy tính người sử dụng. Sở hữu chìa khóa mở khóa giao dịch là điều kiện tiên quyết duy nhất để chi tiêu bitcoin, đưa toàn bộ quyền kiểm soát vào tay của mỗi người dùng.</p>
<p>&nbsp Bitcoin là một hệ thống peer to peer, fully-distributed. Như là không có server trung tâm hoặc điểm điều khiển. Bitcoin được tạo thông qua quy trình gọi là "mining"-quá trình tìm kiếm lời giải cho 1 bài toán khó. Bất kỳ người tham gia trong mạng lưới bitcoin có thể là tác nhân như 1 miner(người đào), sử dụng năng lượng máy tính để cố gắng tìm lời giải cho bài toán này. Cứ trung bình 10 phút thì sẽ có ai đó tìm ra lời giải, và được thưởng 1 số tiền bitcoin nào đó.</p>
<p>&nbsp Giao thức bitcoin bao gồm các thuật toán tích hợp điều chỉnh chức năng đào trên mạng. Khó khăn của vấn đề mà người đào phải giải quyết được điều chỉnh động sao cho cứ trung bình 10 phút thì tìm được 1 lời giải chính xác trong tổng tất cả các người tham gia đào. Giới hạn số coin là 21 triệu coin và theo tính toán thì đến năm 2140 thì số bitcoin sẽ tạo ra là 21 triệu coin.</p>
<p>&nbsp Bên cạnh đó thì bitcoin cũng là tên của giao thức, 1 mạng, và một sự đổi mới phân tán máy tính. Đồng tiền bitcoin thực sự chỉ là ứng dụng đầu tiên của sự sáng chế này. Là một nhà phát triển, tôi thấy bitcoin như là một đồng tiền internet, một mạng lưới để truyền bá giá trị đồng tiền và đảm bảo chủ sỡ hữu tài sản thông qua mạng lưới phân tán.</p>
<p>&nbsp Ở chương này, chúng tôi bắt đầu bởi giải thích vài khái niệm chính, đưa ra các phần mềm cần thiết và sử dụng bitcoin cho một vài giao dịch đơn giản. Trong các chương tiếp theo, chúng ta sẽ tìm hiểu về các công nghệ được sử dụng trong bitcoin.</p>

<h4>Lịch sử bitcoin</h4>
<p>&nbsp Bitcoin được phát minh vào năm 2008 bởi Satoshi Nakamoto với việc đăng 1 bài báo có title :"Bitcoin: A Peer-to-Peer Electronic Cash System". Satoshi Nakamoto kết hợp một số phát minh trước như b-money và HashCash để tạo ra một hệ thống tiền mặt điện tử hoàn toàn không  tập trung mà không dựa vào một cơ quan trung ương để phát hành tiền tệ hoặc thanh toán và xác nhận giao dịch. Sự đổi mới quan trọng là sử dụng hệ thống tính toán phân tán để tạo ra 1 bitcoin sau 10 phút, cho phép mạng không tập trung đi đến sự đồng thuận về trạng thái giao dịch. Có 1 vấn đề ở đây là double-spend, tức là 1 đồng tiền có thể được tiêu 2 lần thì bitcoin đã giải quyết được. Trước đây, vấn đề này là một sự nhạy cảm của các đồng tiền kĩ thuật số và được giải quyết bằng cách xóa tất cả các giao dịch thông qua một trung tâm thanh toán bù trừ trung tâm.</p>
<p>Mạng lưới bitcoin được bắt đầu vào năm 2009, dựa trên một tài liệu tham khảo được publish bởi Nakamoto và bởi nhiều lập trình viên khác. Tính toán phân tán cung cấp bảo mật và khả năng phục hồi bitcoin tăng theo cấp số nhân và bây giờ vượt qua năng lực tính toán của các siêu máy tính trên thế giới kết hợp lại với nhau. Tổng giá trị thị trường của Bitcoin ước tính từ 5 đến 10 tỷ đô la Mỹ. Giao dịch lớn nhất tính đến hiện nay.</p>
<p>Satoshi Nakamoto rút khỏi công chúng vào tháng 4 năm 2011, để lại trách nhiệm phát triển mã và mạng cho các group tình nguyện. Tên của Satoshi Nakamoto là 1 tên bí danh và hiện giờ vẫn chưa biết được chính xác người đó là ai. Tuy nhiên, Nakamoto hay ai đó cũng không thể điều khiển hệ thống bitcoin. Bản thân phát minh này là đột phá và đã sinh ra khoa học mới trong các lĩnh vực điện toán phân tán, kinh tế và kinh tế lượng.</p>
<h4>Bitcoin Uses, Users và Their Stories</h4>
<p>Bitcoin là một công nghệ, nhưng nó thể hiện bản chất là tiền. Hãy xem mọi người sử dụng bitcoin và một số cách sử dụng tiền tệ và các giao thức thông qua their stories. Chúng tôi sẽ tái sử dụng những câu chuyện này trong suốt cuốn sách để minh họa việc sử dụng tiền kỹ thuật số trong thực tế và cách chúng được tạo ra bởi các công nghệ khác nhau.</p>
<h4>Getting Started</h4>
<p>Để tham gia vào mạng lưới bitcoin và bắt đầu sử dụng tiền, tất cả người dùng tải xuống một ứng dụng hoặc sử dụng 1 trang web. Vì bitcoin là một chuẩn, có nhiều cách triển khai của bitcoin client software. Cũng có một "reference implementation", cũng được biết tới như Satoshi Client, cái này được quản lý như một dự án mã nguồn mở bởi 1 team phát triển và  có nguồn gốc từ việc thực hiện ban đầu của Satoshi Nakamoto</p>
<ul>Ba hình thức chính của bitcoin client là: 
<li>Full Client : Một full client hoặc "full node" là một client lưu trữ toàn bộ lịch sử giao dịch của bitcoin ( Mọi giao dịch bởi mọi người), quản lý ví người dùng và có thể khởi tạo giao dịch trực tiếp trên mạng bitcoin. Điều này tương tự một máy chủ mail độc lập, xử lý tất cả các khía cạnh của giao thức mà không dựa vào bất kỳ máy chủ nào khác hoặc dịch vụ của bên thứ ba.
</li>
<li>
Light client: Một lightweight client lưu trữ ví người dùng nhưng dựa vào máy chủ bên thứ 3 cho truy cập giao dịch bitcoin và mạng. The light client không lưu trữ một bản sao đầy đủ của tất cả các giao dịch và vì thế phải tin tưởng vào máy chủ của bên thứ 3 cho việc xác thực giao dịch. Điều này tương tự một máy khách email client độc lập kết nối với một mail server cho việc truy cập một mailbox, nó dựa vào bên thứ 3 cho việc tương tác với mạng.
</li>
<li>Web Client: Web-Client được truy cập thông qua trình duyệt web browser và lưu trữ ví người dùng trên một server-được làm chủ bên thứ 3. Nó tương tự như một webmail dựa vào hoàn toàn server bên thứ 3.</li>
</ul>
---------------------------------------------
<h4>Mobile Bitcoin</h4>
<p>Mobile clients cho điện thoại thông minh, chẳng hạn như Android, có thể hoạt động như full clients, light clients hoặc web clients. Một vài mobile client được đồng bộ hoá với web hoặc desktop client, cung cấp ví đa nền tảng trên nhiều thiết bị nhưng chung một nguồn tiền.</p>
----------------------------------------
<p>Một full client sẽ cung cấp mức kiểm soát và độc lập cao nhất cho người sử dụng, nhưng lần lượt đặt gánh nặng của sao lưu và bảo mật cho người dùng. Một khía cạnh khác của phạm vi lựa chọn, một web client là cách dễ nhất để cài đặt và sử dụng, nhưng có sự rủ ro về bảo mật. Nếu một web-wallet service bị tổn hại, như nhiều người đã tưng, người sử dụng có thể mất tất cả tiền của họ. Ngược lại, nếu một người dùng có một full client mà không sao lưu đầy đủ, họ có lẽ mất tiền của họ thông qua một tai nạn máy tính.</p>
<h2>Chương 2: How Bitcoin Works</h2>
<h4> Transactions, Blocks, Mining and the Blockchain</h4>
<p>Hệ thống bitcoin, không giống với hệ thống banking và thanh toán truyền thống, dựa trên sự tin tưởng phi tập trung. Thay vì một cơ quan trung tâm đáng tin cậy, trong bitcoin, sự tin tưởng được thực hiện như là một tài sản nổi bật từ các tương tác của những người tham gia khác nhau trong hệ thống bitcoin. Ở trong chương này chúng ta sẽ xem xét bitcoin từ một mức cao bởi theo dõi một giao dịch thông qua hệ thống bitcoin và xem như nó trở thành " đã tin cậy" và chấp nhận bởi cơ chế đồng thuận phân tán và cuối cùng được ghi lại trên chuỗi blockchain, sổ cái phân tán của tất cả các transaction.</p>
<p>Mỗi ví dụ dưới đây được dựa trên vi dụ thực tế được thực hiện trên mạng bitcoin, mô phỏng tương tác giữa người dùng (joe, Alice, và Bod) bởi gửi tiền từ một ví đến người khác. Trong khi theo dõi một giao dịch thông qua mạng bitcoin network và blockchain, chúng ta sẽ sử dụng blockchain explorer để hình dung từng bước. Một blockchain explorer là một ứng dụng web mà hoạt động như là một công cụ tìm kiếm bitcoin (bitcoin search engine), nó chấp nhận bạn tìm kiếm address, transaction và block và nhìn mối quan hệ và theo dõi giữa chúng</p>
<ul>Popular blockchain explorers bao gồm:
<li>blockchain.info</li>
<li>blockexplorer.com</li>
<li>insight.bitpay.com</li>
<li>blockr.io</li>
</ul>
<p>Mỗi một trong số này có chức năng tìm kiếm có thể lấy một địa chỉ, số băm giao dịch hoặc số khối và tìm dữ liệu tương đương trên mạng bitcoin và blockchain. Với mỗi ví dụ, bạn sẽ cung cấp một URL để đưa bạn đến trực tiếp mục có liên quan để bạn có thể nghiên cứu chi tiết </p>
<h4>Bitcoin Overview</h4>
<p>Ở trong biểu đồ tổng quan bên dưới chúng ta có thể thấy rằng hệ thống bitcoin bao gồm user với ví chứ keys, transactions cái mà được truyền qua mạng và thợ mỏ sản xuất (thông qua cạnh tranh tính toán)  thông qua cơ chế đồng thuận, sổ cái có thẩm quyền của tất cả các giao dịch. Trong chương này, chúng tôi sẽ theo dõi một giao dịch duy nhất khi nó di chuyển qua mạng và kiểm tra tương tác giữa mỗi phần của hệ thống bitcoin, ở mức cao. Chương tiếp theo chúng tôi sẽ đào sâu về công nghệ phía sau wallets, hệ thống mining và buôn bán.</p>
<h1>Chapter 4: Keys, Addresses, Wallets</h1>
<h4>Introduction</h4>
<p>Quyền sở hữu bitcoin được thiết lập thông qua digital key, bitcoin address và digtal signatures. The digital keys không thực sự được lưu trữ trên mạng, nhưng nhưng thay vào đó được tạo và lưu trữ bởi người dùng cuối trong một tệp, hoặc database đơn giản, gọi là một wallet. Các khóa kỹ thuật số (digital keys)  trong ví của người dùng hoàn toàn độc lập với giao thức bitcoin và có thể được tạo và quản lý bằng phần mềm ví của người dùng mà không cần tham chiếu đến blockchain hoặc truy cập Internet. Các key cho phép nhiều thuộc tính thú vị của bitcoin, bao gồm cả sự tin cậy và kiểm soát phi tập trung, xác nhận quyền sở hữu và mô hình bảo mật bằng chứng mật mã</p>
<p>Mỗi giao dịch bitcoin yêu cầu một chữ ký hợp lệ để được bao gồm trong blockchain, cái có thể chỉ được tạo với digital key xác thực, do đó bất cứ ai với bản sao key đó đều có quyền điều khiển bitcoin trong tài khoản đó. Các key theo cặp bao gồm private key (secret) và public key. Nghĩ đơn giản thế này, public key tương đương là một số tài khoản ngân hàng và private key tương tự là một số PIN bí mật hoặc chữ ký trên séc mà cung cấp kiểm soát tài khoản. Digital key rất hiếm khi được người dùng nhìn thấy. Hầu hết, chúng được lưu trữ bên trong tập tin ví và được quản lý bởi phần mềm ví bitcoin.</p>
<p>Trong phần giao dịch bitcoin, public key của người nhận được đại diện bởi dấu vân tay kỹ thuật số của nó, được gọi là một địa chir bitcoin (bitcoin address), cái mà được sử dụng giống như tên của người thụ hưởng trên sec. Trong hầu hết các trường hợp, địa chỉ bitcoin được tạo ra và tương ứng với khóa công khai (public key). Tuy nhiên, không phải tất cả địa chỉ bitcoin đại diện public keys, họ cũng có thể đại diện cho những người hưởng lợi khác, cái mà chúng ta sẽ tìm hiểu ở sau chương này. Cách này, địa chỉ bitcoin trừu tượng cho người nhận tiền, làm cho các điểm đến giao dịch linh hoạt, tương tự như paper cheques: một thanh toán đơn có thể được sử dụng để trả vào tài khoản mọi người, công ti hoặc trả cho hoá đơn hoặc tiền mặt. Địa chỉ bitcoin chỉ đại diện cho keys mà người dùng thường xuyên thấy, vì đây là phần họ cần chia sẽ với thế giới.  </p>
<p>Trong chương này chúng tôi sẽ giới thiệu ví, cái mà chứa các khoá mã hoá. Chúng tôi sẽ xem xét cái tạo, lưu trữ và quản lý khoá. Chúng tôi sẽ xem xét các định dạng mã hóa khác nhau được sử dụng để đại diện cho các private và public keys, địa chỉ và script address. Cuối cùng chúng tôi sẽ xem xét key sử dụng đặc biệt: để ký thông điệp, chứng minh quyền sở hữu và để tạo địa chỉ ảo và ví giấy.  </p>
<h4>Public key cryptography và crypto-curency</h4>
<p>Mật mã khoá công khai (public key cryptography) được phát minh vào 1970s và đây là nền tảng toán học bảo mật máy tính và thông tin </p>
<p>Kể từ khi phát minh ra mật mã hoá công khai, một số hàm toán học phù hợp, chẳng hạn như luỹ thừa số nguyên tố, và phép nhân đường cong elip, đã bị loại bỏ. Các hàm toán học này thực tế không thể đảo ngược, nghĩa là họ dễ dàng tính toán ở 1 chiều, không thể tính toán theo chiều ngược lại. Dựa trên hàm toán học, mật mã hoá cho phép tạo ra digital secret và digital signatures. Bitcoin sử dụng phép nhân đường cong elliptic làm cơ sở cho mật mã khóa công khai của nó</p>
<p>Trong bitcoin, chúng ta sử dụng mã hoá công khai để tạo một cặp key mà điều khiển truy cập bitcoin. Cặp key này bao gồm private key và  public key. Public key được sử dụng để nhận bitcoins và private key được sử dụng để ký giao dịch để gửi bitcoin.</p>
<p>Có một mỗi quan hệ toán học giữ public key và private key mà cho phép private key được sử dụng để tạo chữ ký trên thông điệp. Chữ ký có thể được xác thực bởi khoá public key mà không tiết lộ private key.</p>
<p>Khi gửi bitcoin, chủ bitcoin hiện tại trình bày khoá công khai (public key) và chữ ký của họ (khác nhau mỗi thời gian, nhưng tạo từ private key như nhau) trong một giao dịch để gửi những bitcoin đó. Thông qua việc trình bày public key và chữ kí, mỗi người trên mạng bitcoin có thể xác thực và chấp nhận giao dịch hợp lệ, xác nhận rằng người chuyển bitcoin sở hữu chúng tại thời điểm chuyển</p>
<i>Trong đa số các ví thực hiên, private và public keys được lưu trữ cùng nhau như một cặp key cho thuận lợi. Tuy nhiên, public key có thể được tính toán từ private key, vì vậy lưu trữ chỉ private key cũng có thể.</i>
<h4>Private và Public Keys</h4>
<p>Một ví bitcoin chứa một bộ sưu tập các cặp key, mỗi key gồm có private key và public key. Private key (k) là một số, thường được chọn ngẫu nhiên. Từ private key, chúng tôi sử dụng phép nhân đường cong elip, một hàm mật mã một chiều, để tạo public key (K). Từ public key (K), chúng tôi sử dụng hàm băm mật mã một chiều để tạo một địa chỉ bitcoin (A). Trong phần này, chúng tôi sẽ bắt đầu với tạo private key, xem xét đường cong elip được sử dùng để chuyển sang public key, và cuối cùng, tạo một địa chỉ bitcoin từ public key. Mối quan hệ giữa private key, public key và địa chỉ bitcoin như hình bên dưới </p>
<img src="http://sv1.upsieutoc.com/2018/06/15/Screenshot-from-2018-06-15-17-53-01.png"     alt="Markdown Monster icon"     style="float: left; margin-right: 10px;" />
<h4>Private Keys</h4>
<p>Một private key đơn giản là một số, được chọn ngẫu nhiên. Quyền sở hữu và kiểm soát private key là gốc của điều khiển người dùng với tất cả tiền liên kết địa chỉ bitcoin tương ứng. Private key được sử dụng để tạo chữ ký, cái mà được yêu cầu để gửi bitcoin bởi cung cấp quyền sở hữu tiền được sử dụng trong giao dịch. Private key phải duy trì bảo mật ở tất cả các thời điểm, tiết lộ bên thứ 3 tương đương với việc giao quyền kiểm soát bitcoin bởi cái private key. Private keycũng phải được sao lưu và được bảo vệ khỏi mất mát do vô tình, vì nếu bị mất thì không thể phục hồi được và số tiền được bảo đảm bởi nó sẽ bị mất vĩnh viễn</p>
<i>Private key của bitcoin chỉ là một số. Bạn có thể chọn private key ngẫu nhiên chỉ bằng đồng xu, bút chì và tờ giấy: Quăng 1 đồng xu 256 lần và bạn có dãy số nhị phân ngâu nhiên của private key mà bạn có thể sử dụng ở 1 ví bitcoin. Public key có thể được tạo từ private key.</i>
<h5>Generating a private key from a random number</h5>
<p>Bước đầu tiên và quan trọng trong tạo keys là tìm một nguồn entropy an toàn hoặc ngẫu nhiên. Tạo khoá bitcoin về cơ bản giống như chọn 1 số giữa 1 và 2^256. Phương pháp chính xác bạn sử dụng để chọn một số không quan trọng lắm, miễn là nó không thể dự đoán hoặc lặp lại được. Phần mềm bitcoin sử dụng các trình tạo số ngẫu nhiên của hệ điều hành cơ bản để tạo ra 256 bit entropy (randomness). Thông thường, hệ điền hành tạo số ngẫu nhiên được khởi tạo bởi một nguồn ngẫu nhiên của con người.</p>
<p>Chính xác hơn, private key có thể bất kỳ số nào giữa 1 với n-1, ở đây n là một hằng số (n=1.158*10^77, hơi nhỏ hơn 2 ^256) được định nghĩa là thứ tự của đường cong elip được sử dụng trong bitcoin. Để tạo ra một key như vậy, chúng ta chọn ngẫu nhiên một số 256-bit và kiểm tra rằng nó nhỏ hơn n-1.  Thực hiện bởi thuật toán hàm băm SHA-256 hash. Nếu kết quả nhỏ hơn n-1, thì đây là một kết quả phù hợp. Ngược lại, chúng ta đơn giản là thử tìm lại với một số ngẫu nhiên khác.</p>
<i>Không viết mã riêng của bạn để tạo một số ngẫu nhiên hoặc sử dụng một số ngẫu nhiên được tạo bởi ngôn ngữ lập trình của bạn. Nghiên cứu tài liệu của thư viện tạo số ngẫu nhiên, bạn chọn để chắc chắc nó mã hoá bảo mật. </i>
<p>Dưới đây là một private key được tạo trong định dạng hexa (256 binary digits, hiển thị dưới dạng 64 số hex): </p>
<p>Private key (k) tạo ngẫu nhiên:
<a>1E99423A4ED27608A15A2616A2B0E9E52CED330AC530EDCC32C8FFC6A526AEDD</a>
</p>
<i>Kích thước không gian của private key, 2^256 là một số lớn. Nó xấp xỉ 10 ^77 trong decimak. Vũ trụ ước tình có 10 ^80 nguyên tử. </i>
<h4>Public Keys</h4>
<p>Public key được tính từ private key sử dụng phép nhân đường cong elip:K=k*G, ở đây k là private key, G là một điểm liên tục gọi là Generator Point và K là kết quả của Public Key. Các hoạt động ngược lại, được gọi là "tìm logarit rời rạc" - tính k nếu bạn biết K - là khó khăn như cố gắng tất cả các giá trị có thể có của k, tức là, một tìm kiếm brute-force. Trước khi chúng tôi chứng minh tạo một public key từ private key như thế nào, hãy xem xét Elliptic Curve Cryptography chi tiết hơn một chút </p>
<h4>Giải thích mật mã đường cong Elliptic</h4>
<p>Elliptic Curve Cryptography là một loại bất đối xứng hoặc mã hoá công khai dựa trên  bài toán logarit rời rạc được biểu diễn bằng phép cộng và phép nhân trên các điểm của đường cong elip.</p>
<p>Dưới đây chúng ta xem ví dụ về một elliptic curve, tương tự như sử dụng bởi bitcoin: </p>
<img src="http://sv1.upsieutoc.com/2018/06/16/Screenshot-from-2018-06-16-00-22-20.png" />
<p>Bitcoin sử dụng một đường cong elliptic cụ thể và một tập các hằng số toán học, được định nghĩa trong một chuẩn gọi là secp256k1, thiết lập bởi National Institute of Standard and Technology (NIST). Đường cong secp256k1 được định nghĩa bởi hàm sau: </p>
<img src="http://sv1.upsieutoc.com/2018/06/16/Screenshot-from-2018-06-16-00-28-57.png" />
<p>The mod p (modulo số nguyên tố p) cho biết răng đường cong này nằm trên trường hữu hạn của bậc tự p, cũng được viết là Fp, ở đây p=2^256 - 2 ^32 - 2 ^9 - 2 ^8 - 2 ^7 -2 ^6 -2 ^4 - 1, một số nguyên tố rất lớn.</p>
<p>Bởi vì đường cong được định nghĩa trên một trường hữu hạn của thứ tự nguyên tố thay vì trên số thực, nó trông giống như một mẫu dấu chấm nằm rải rác ở hai chiều, làm cho khó hình dung. Tuy nhiên, toán học giống hệt với đường cong elliptic so với các số thực được trình bày ở trên. Ví dụ, dưới đây là cùng một đường cong elliptic trên một trường hữu hạn nhỏ hơn nhiều của trật tự nguyên tố 17, cho thấy một mẫu dấu chấm trên một lưới. Đường cong elip bitcoin secp256k1 có thể được coi là một mẫu dấu chấm phức tạp hơn trên một lưới lớn không thể dò được</p>
<img src="http://sv1.upsieutoc.com/2018/06/16/Screenshot-from-2018-06-16-07-59-37.png" />
<p>Cho ví dụ, dưới đây là một điểm P với toạ độ (x, y) mà nó là một điểm trong đường cong secp256k1. Bạn có thể kiểm tra nó bằng cách sử dụng python </p>
<img src ="http://sv1.upsieutoc.com/2018/06/16/Screenshot-from-2018-06-16-08-03-27.png" />
<p>Đường cong toán học elliptic, nó là một điểm gọi là "điểm vô cùng", trong đó khoảng tương ứng với vai trò của 0 được thêm. Trên máy tính, đôi khi nó được biểu thị bằng x = y = 0 (không thỏa mãn phương trình đường cong elip - nhưng đó là một trường hợp riêng biệt dễ dàng có thể được kiểm tra). </p>
<p>Ngoài ra còn có một toán tử “+”, được gọi là "addition" trong đó có một số tài sản tương tự như việc bổ sung truyền thống của số thực mà trẻ em học lớp học. Với hai điểm P1 và P2 trên đường cong elliptic, có điểm thứ ba là P3 = P1 + P2, cũng trên đường cong elip</p>
<p>Trong hình học, điểm thứ P3 được tính bởi vẽ 1 đường giữa P1 và P2. Đường này sẽ cắt đường cong elip ở chính xác một vị trí bổ sung. Goị điểm này là P3' = (x,y). Sau đó phản ánh trong trục X để lấy P3 = (x, -y). </p>
<p>Có một vài trường hợp đặc biệt giải thích sự cần thiết cho “điểm vô hạn”.</p>
<p>Nếu P1 và P2 là cùng một điểm, dòng “giữa” P1 và P2 sẽ mở rộng thành đường tiếp tuyến trên đường cong tại điểm P1. Đường tiếp tuyến này sẽ cắt đường cong chính xác tại một điểm mới. Bạn có thể sử dụng các kỹ thuật từ phép tính để xác định độ dốc của đường tiếp tuyến. Những kỹ thuật này làm việc tò mò mặc dù chúng tôi đang hạn chế sự quan tâm của chúng tôi đối với các điểm trên đường cong với hai tọa độ nguyên!</p>
<p>Trong một số trường hợp (tức là, nếu P1 và P2 có cùng giá trị x nhưng giá trị y khác nhau), đường tiếp tuyến sẽ chính xác theo chiều dọc, trong trường hợp này P3 = “điểm ở vô cực”</p>
<p>Nó chỉ ra rằng + là kết hợp, có nghĩa là (A + B) + C = A + (B + C). Điều đó có nghĩa là chúng ta có thể viết A + B + C mà không có dấu ngoặc đơn mà không có bất kỳ sự mơ hồ nào</p>
<p>Bây giờ chúng ta đã định nghĩa bổ sung, chúng ta có thể định nghĩa phép nhân theo cách tiêu chuẩn để mở rộng thêm. Đối với điểm P trên đường cong elliptic, nếu k là một số nguyên thì kP = P + P + P +… + P (k lần). Lưu ý rằng k đôi khi bị nhầm lẫn được gọi là "số mũ" trong trường hợp này.</p>
<h5>Tạo 1 Public key</h5>
<p>Bắt đầu với một private key trong form của một số tạo ngẫu nhiên k, chúng ta nhân nó với một điểm định trước trên đường cong được gọi là generator point G để tạo ra một điểm khác ở đâu đó trên đường cong, đó là khóa public key tương ứng K. Điểm  generator point được xác định là một phần của tiêu chuẩn secp256k1 và luôn giống nhau đối với tất cả các khóa trong bitcoin</p>
<i>K = k*G</i>
<p>Ở đây, k là private key, G là generator point và K là kết quả của public key, một điểm trên đường cong. Vì generator point luôn luôn giống cho tất cả các người dùng bitcoin, một private key k nhân với G sẽ luôn luôn dẫn đến public key K. Mỗi quan hệ giữa k và K là cố định, nhưng có thể chỉ tính toán một chiều, từ k sang K. Đó là lý do tại sao một địa chỉ bitcoin address(bắt nguồn từ K) có thể chia sẽ với mọi người và không tiết lộ được private key (k). </p>
<i>Một private key có thể được chuyển sang một public key, nhưng một public key không thể chuyển về private key bởi vì phép toán chỉ làm việc một chiều</i>
<p>Thực hiện phép nhân đường cong elliptic trên, chúng ta lấy private key k và nhân nó với G: </p>
<img src="http://sv1.upsieutoc.com/2018/06/16/Screenshot-from-2018-06-16-15-47-33.png"/>
<p>Để hình dung phép nhân của một điểm với một số nguyên, chúng tôi sẽ sử dụng đường cong elliptic trên các số thực - nhớ răng, toán học giống nhau. Mục tiêu chúng tôi là tìm phép nhân kG của điểm generator point G. cũng giống như thêm G vào bản thân chính nó k lần trong một hàng. Trong đường cong elliptic, thêm một điểm vào bản thân chính nó là tương đương vẽ một đường tiếp tuyến trên một điểm và tìm nơi nó cắt đường cong một lần nữa, sau đó ánh xạ điểm đó trên trục x.</p>
<p>Sơ đồ dưới đây cho thấy quá trình tạo ra G, 2G, 4G, như một phép toán hình học trên đường cong</p>
<img src="http://sv1.upsieutoc.com/2018/06/16/Screenshot-from-2018-06-16-15-58-56.png" />
<h4>Bitcoin address</h4>
<p>Một địa chỉ bitcoin là một chuỗi số và các kí tự mà có thể được chia sẽ với bất kỳ ai, nhuững người muốn gửi tiền cho bạn. Địa chỉ được tạo ra từ khóa công khai bao gồm một chuỗi các số và chữ cái, bắt đầu bằng chữ số “1”. Ở đây là một ví dụ của địa chỉ bitcoin: <a>1thMirt546nngXqyPEz532S8fLwbozud8</a></p>
<p>Địa chỉ bitcoin là địa chỉ xuất hiện phổ biến nhất trong giao dịch với tư cách là "người nhận" tiền. Nếu chúng ta so sánh một giao dịch bitcoin với một tờ séc bằng giấy, địa chỉ bitcoin là người thụ hưởng, đó là những gì chúng tôi viết trên dòng sau khi “Thanh toán cho đơn đặt hàng của”. Trong séc giấy, người hưởng lợi có thể là tên của chủ tài khoản ngân hàng, nhưng cũng có thể là tổ chức, công ty. Bởi vì séc giấy không cần phải chỉ định một tài khoản, nhưng thay vì sử dụng một tên trừu tượng như người nhận tiền, mà làm cho kiểm tra giấy rất linh hoạt như các công cụ thanh toán. Các hành động chuyển bitcoin sử dụng một sự trừu tượng tương tự, địa chỉ bitcoin, để làm cho chúng trở nên rất linh hoạt. Một địa chỉ bitcoin có thể đại diện chủ sở hữu một cặp khoá private key/ public key, hoặc nó có thể đại diện thứ gì khác, chẳng hạn nhuư một payment script, như chúng ta sẽ thấy trong "Pay to Script Hash (P2SH)". Bây giờ, hãy xem xét trường hợp đơn giản, một địa chỉ bitcoin đại diện và có nguồn góc từ một public key.</p>
<p>Một địa chỉ bitcoin có nguồn gốc từ public key thông qua sử dụng sự băm mã hoá một chiều hashing, một thuật toán "hashing algorithm" hoặc đơn giản là "hash algorithm" là hàm một chiều tạo ra một fingerprint hoặc băm của đầu vào có kích thước tuỳ ý. Hàm băm mã hoá được sử dụng rộng rãi trong bitcoin: trong bitcoin address, trong script address và trong thuật toán đào "Proof-of-Work". Thuật toán sử dụng để tạo một địa chỉ bitcoin từ một public key là Secure Hash Algorithm (SHA) và RACE Integrity Primitives Evaluation Message Digest (RIPEMD), đặc biệt SHA256 và RIPEMD160.</p>
<p>Bắt đầu với public key K, chúng ta tính toán băm SHA256 và sau đó tính toán băm RIPEMD160 của kết quả đó, tạo ra một số 160bit (20 byte): </p>
<a>A = RIPEMD160(SHA256(K))</a>
<i>Ở đây K là public key và A là kết quả của địa chỉ bitcoin</i>
<i>Một địa chỉ bitcoin không giống như một public key. Địa chỉ bitcoin có nguồn gốc từ một public key sử dụng hàm một chiều.</i>
<p>Địa chỉ Bitcoin hầu như luôn được hiển thị cho người dùng trong một mã hóa có tên “Base58Check”, cái mà sử dụng 58 kí tự (a base-58 number system) và một checksum giúp người đọc dễ đọc, tránh sự mơ hồ và bảo vệ chống lại các lỗi trong phiên mã và ghi địa chỉ. Base58Check cũng được sử dụng theo nhiều cách khác trong bitcoin, bất cứ khi nào có nhu cầu người dùng đọc và ghi chính xác một số, chẳng hạn như địa chỉ bitcoin, khóa riêng, khóa được mã hóa, hoặc một script hash. Trong phần tiếp theo, chúng tôi sẽ xem xét cơ chế mã hóa và giải mã Base58Check và các biểu diễn kết quả.</p>
<img src="http://sv1.upsieutoc.com/2018/06/16/Screenshot-from-2018-06-16-18-59-37.png" />
<h4>Base58 và Base58Check Encoding</h4>
<h6>Base-58 Encoding</h6>
<p>Để đại diện cho các số dài theo một cách nhỏ gọn, sử dụng ít kí hiệu hơn, nhiều hệ thống máy tính sử dụng biểu diễn hỗn hợp chữ và số với một cơ số (hoặc cơ số) cao hơn 10.  Ví dụ, trong khi cơ số 10 sử dụng các số từ 0 đến 9, thì hệ hexa sử dụng 16 số với thêm các ký tự A đến F. Một số đại diện trong Hex ngắn hơn tương đương hệ số 10 tương ứng.  Nhỏ gọn hơn, Base-64 sử dụng 26 ký tự thường, 26 kí tự hoa, 10 con số và 2 kí tự "+" và "/" để truyền dữ liệu nhị phân qua văn bản như email. Base-64 được sử dụng phổ biến để đính kèm tệp nhị phân vào email. Base-58 là một mã hoá nhị phân cho văn bản phát triển cho sử dụng trng bitcoin và sử dụng trong nhiều loại tiền tệ khác. Nó đại diện cho sự nhỏ gọn, dễ phát hiện lỗi và phòng người. Base-58 là một tập con của Base-64, sử dụng kí tự hoa và thường và số, nhưng bỏ qua một số ký tự thường bị nhầm lẫn với nhau và có thể xuất hiện giống hệt nhau khi được hiển thị trong một số phông chữ nhất định. Đặc biệt, Base-58 là Base-64 thiếu số 0, O (o), l (L), I(i) và "\ +" và "/". Hoặc đơn giản hơn, nó là một tập chữ hoa, thường và số thiếu 4 kí tự (0,O,l,I) được đề cập ở trên.</p>
<p>Bảng chữ cái Base-58 của Bitcoin: 
<i>123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz</i>
</p>
<h6>Base58Check Encoding</h6>
<p>Để tăng cường bảo mật chống lại lỗi chính tả hoặc lỗi phiên âm. Base-58Check là một Base-58 encoding format, thường được sử dụng trong bitcoin, cái mà có mã kiểm tra code. Checksum là bốn byte bổ sung được thêm vào cuối dữ liệu đang được mã hóa. The checksum bắt nguồn từ băm của dữ liệu được mã hóa và do đó có thể được sử dụng để phát hiện và ngăn chặn phiên mã vf đánh lỗi. Khi ngăn chặn với một Base58Check, phần mềm giải mã sẽ tính toán checksum của dữ liệu và so sánh nó với checksum bao gồm trong code. Nếu cả 2 không khớp nhau, chỉ ra rằng một lỗi đã được phát hiện và dữ liệu Base58Check không hợp lệ. Ví dụ,  điều này ngăn không cho địa chỉ bitcoin bị nhầm lẫn không được phần mềm ví tiền chấp nhận làm điểm đến hợp lệ, một lỗi sẽ dẫn đến mất tiền.</p>
<p>Để chuyển dữ liệu (một số) sang một định dạng Base58Check, chúng ta thêm một tiền tố vào dữ liệu, gọi là "version byte", phục vụ để dễ dàng xác định loại dữ liệu được mã hóa. Ví dụ, trong trường hợp một tiền tố địa chỉ bitcoin là zero (0x00 trong hex),  trong khi tiền tố sử dụng khi mã hoá một private key là 128 (0x80 trong hex). Một dah sách version phổ biến được hiển thị ở Table 4-1. </p>
<p>Tiếp theo tính tán "double-SHA" checksum, nghĩa là chúng ta áp dụng thuật toán SHA256 hash-algorithm 2 lần (prefix và data): </p>
<i>checksum = SHA256(SHA256(prefix+data))</i>
<p> Từ kết quả 32-byte hash (hash-of-a-hash), chúng ta chỉ chúng tôi chỉ lấy bốn byte đầu tiên. Bốn byte này đóng vai trò là mã kiểm tra lỗi hoặc checksum. checksum được kết nối (nối thêm) vào cuối. Kết quả của phần trên bây giờ là prefix, data và một checksum. Kết quả này được mã hóa bằng bảng chữ cái cơ bản-58 được mô tả trong phần trên.</p>
<img src="http://sv1.upsieutoc.com/2018/06/17/Screenshot-from-2018-06-17-07-44-12.png" />
<p>Trong bitcoin, hầu hết các dữ liệu được trình bày cho người dùng là Base58Check được mã hóa để làm cho nó nhỏ gọn, dễ đọc và dễ phát hiện lỗi. Tiền tố version trong mã hoá Base58Check được sử dụng để tạo ra các định dạng dễ phân biệt, khi được mã hóa trong Base-58 có chứa các ký tự cụ thể ở đầu của payload được mã hóa Base58Check, giúp con người dễ dàng xác định loại dữ liệu được mã hóa và cách sử dụng nó. Đây là điểm khác biệt, ví dụ, địa chỉ bitcoin được mã hóa Base58Check bắt đầu bằng “1” từ định dạng WIF khóa private key mã hóa  Base58Check bắt đầu bằng “5”. Vài ví dụ version prefix và kết qủa base-58 :</p>
<img src="http://sv1.upsieutoc.com/2018/06/17/Screenshot-from-2018-06-17-07-58-28.png" />
<h5>Creating a bitcoin address from a private key</h5>
<p>Hãy xem xét quá trình tạo địa chỉ bitcoin hoàn chỉnh, từ private key sang public key (1 điểm trên đường cong ellip), rồi double-hashed address và cuối cùng là Base58Check encoding. Mã C ++ trong Ví dụ 4-1 cho thấy quá trình hoàn chỉnh, từ khóa riêng, đến Base58Check địa chỉ bitcoin được mã hóa, từng bước một. Mã ví dụ dưới đây sử dụng thư viện libbitcoin được giới thiệu trong “Các máy khách thay thế, thư viện và bộ công cụ” trên trang 56 cho một số hàm trợ giúp:</p>
<img src="http://sv1.upsieutoc.com/2018/06/17/Screenshot-from-2018-06-17-09-18-19.png" />
<img src="http://sv1.upsieutoc.com/2018/06/17/Screenshot-from-2018-06-17-09-18-54.png" />
<h4>Key Formats</h4>
<h5>Private Key Formats</h5>
<p>Private key có thể được thể hiện bằng một số định dạng  khác nhau, tương ứng với 256-bit giống nhau. Một số định dạng của nó: </p>
<img src="http://sv1.upsieutoc.com/2018/06/17/Screenshot-from-2018-06-17-09-25-56.png" />
<p>Các key ở trên định dạng khác nhau nhưng đó là private key giống nhau. </p>
<img src="http://sv1.upsieutoc.com/2018/06/17/Screenshot-from-2018-06-17-09-33-10.png" />
<h5>Public key formats</h5>
<p>Public key cũng trình bày bằng các cách khác nhau, quan trọng nhất là khoá công khai (public key) được nén hoặc không nén</p>
<p>Như chúng ta thấy ở phiên bản trước, public ky là một điểm trên đường cong elliptic bao gồm một cặp toạ độ (x,y). Nó thường được trình bày với tiền tố 04 theo sau bởi hai số 256 bit, một cái là toạ độ x, một cái là toạ độ y. Tiền tố 04 được sử dụng  để phân biệt các public key không nén, còn các public key nén thì bắt đầu với 02 hoặc 03.</p>
<p>Public key ở đây được tạo bởi private key, hiển thị toạ độ (x,y).</p>
<p>Public key K được định nghĩa như một điểm K = (x,y)</p>
<a>x = F028892BAD...DC341A</a>
<a>y = 07CF33DA18...505BDB</a>
<p>Public key được hiện thị với 520-bit number (130 hex digits) với tiền tố 04, theo sau bởi toạ độ x y: Public key không nén K được hiển thị dưới dạng hex (130 hex digits) như 04xy: </p>
<a>K = 04F028892BAD...505BDB</a>
<h5>Public Key nén</h5>
<p>Các khóa công khai nén được đưa vào bitcoin để giảm kích thước giao dịch và tiết kiệm dung lượng đĩa trên các nút lưu trữ cơ sở dữ liệu khối bitcoin. Hầu hết các giao dịch bao gồm khóa công khai, bắt buộc để xác thực thông tin đăng nhập của chủ sở hữu và chi tiêu bitcoin. Mỗi khóa công khai yêu cầu 520 bit (tiền tố \ + x \ + y), khi nhân với hàng trăm giao dịch trên mỗi khối hoặc hàng chục nghìn lần chuyển đổi mỗi ngày, do đó thêm một lượng đáng kể dữ liệu vào blockchain</p>
<p>Như chúng ta đã thấy trong phần “Khóa công khai” ở trang 65 ở trên, khóa công khai là một điểm (x, y) trên đường cong elliptic. Vì đường cong biểu diễn một hàm toán học, một điểm trên đường cong biểu diễn một giải pháp cho phương trình và do đó nếu chúng ta biết tọa độ x chúng ta có thể tính toán tọa độ y bằng cách giải phương trình y^2 mod p = (x ^3 + 7) mod p. Điều đó cho phép chúng tôi chỉ lưu trữ tọa độ x của điểm khóa công khai, bỏ qua toạ độ y và giảm kích thước của khóa và khoảng trống cần thiết để lưu trữ nó bằng 256 bit. Giảm gần 50% kích thước trong mỗi giao dịch bổ sung thêm nhiều dữ liệu được lưu theo thời gian</p>
<p>Trong khi các khóa công khai không nén có tiền tố là 04, các khóa công cộng nén bắt đầu bằng tiền tố 02 hoặc 03. Hãy xem tại sao có hai tiền tố có thể: vì phía bên trái của phương trình là y^2, có nghĩa là giải pháp cho y là căn bậc hai, có thể có giá trị dương hoặc âm. Bằng trực quan, điều này có nghĩa là tọa độ y kết quả có thể nằm trên trục x hoặc dưới trục x. Như bạn có thể thấy từ đồ thị của đường cong elip, đường cong là đối xứng, có nghĩa là nó được phản xạ giống như một gương bằng trục x. Vì vậy, trong khi chúng ta có thể bỏ qua tọa độ y, chúng ta phải lưu dấu y (dương hoặc âm), hoặc nói cách khác chúng ta phải nhớ nếu nó ở trên hoặc dưới trục x, vì mỗi tùy chọn này đại diện cho điểm khác nhau và một khóa công khai khác. Khi tính đường cong elliptic trong số học nhị phân trên trường hữu hạn của bậc tự p, toạ độ y là chẵn hoặc lẻ, tương ứng với dấu dương / âm như đã giải thích ở trên. Do đó, để phân biệt giữa hai giá trị có thể có của y, chúng tôi lưu trữ một khóa công khai nén với tiền tố 02 nếu y là chẵn, và 03 nếu nó là số lẻ, cho phép phần mềm để suy luận chính xác tọa độ y từ tọa độ x và giải nén khóa công khai đến toàn bộ tọa độ của điểm.</p>
<img src="http://sv1.upsieutoc.com/2018/06/17/Screenshot-from-2018-06-17-10-35-27.png" />
<p>Đây là khóa công khai được tạo trước đó, được hiển thị dưới dạng khóa công cộng nén được lưu trữ trong 264 bit (66 chữ số thập phân) với tiền tố 03 cho biết toạ độ y là số lẻ:</p>
<p>Public key nén K được hiển thị dưới dạng hex (66 hex digits) như K = {02 hoặc 03} x.</p>
<a>K = 03F028892BAD...DC341A</a>
<p>Public key nén ở trên tương ứng với cùng private key, nghĩa là nó được tạo từ cùng private key. Tuy nhiên nó nhìn khác với public key không nén. Quan trọng hơn, nếu chúng ta chuyển đổi Public key nén sang địa chỉ bitcoin sử dụng double-hash function (RIPEMD160(SHA256(K))) nó sẽ tạo ra một địa chỉ bitcoin khác. Đây có thể là mập mờ, gây nhầm lẫn bởi vì nó có nghĩa rằng một single private key có thể tạo một public key được thể hiện ở 2 định dạng khác nhau (nén và không nén), cái này tạo ra 2 địa chỉ bitcoin khác nhau. Tuy nhiên, private key là giống hệt nhau cho 2 địa chỉ bitcoin. </p>
<p>Các public key nén đang dần trở thành mặc định trên các máy khách bitcoin ( bitcoin client), cái mà có tác động đáng kể đến việc giảm kích thước giao dịch.Tuy nhiên, không phải tất cả các máy khách đều hỗ trợ khóa public key nén. Máy client mới hơn cung cấp public key nén phải tính đến các giao dịch từ các máy khách cũ không hỗ trợ khóa public key nén. Điều này là quan trọng khi một ứng dụng ví đang nhập khóa riêng tư (private key) từ một ứng dụng ví bitcoin khác, bởi vì ví mới cần scan the blockchain để tìm transaction tươn ứng với các khoá được nhập này. Địa chỉ bitcoin nào sẽ quét ví bitcoin? Các địa chỉ bitcoin được tạo ra bởi các khóa công khai không nén, hoặc các địa chỉ bitcoin được tạo ra bởi các khóa công khai nén? Cả hai đều là địa chỉ bitcoin hợp lệ và có thể được ký bằng khóa riêng (private key), nhưng chúng là các địa chỉ khác nhau! </p>
<p>Để giải quyết vấn đề này, khi private key được xuất từ một ví, Định dạng nhập Wallet được sử dụng để đại diện cho chúng được triển khai khác nhau trong các ví bitcoin mới hơnđể chỉ ra rằng các khóa riêng này đã được sử dụng để sản xuất các khóa công khai nén và do đó các địa chỉ bitcoin được nén. Điều này cho phép ví nhập dữ liệu vào phân biệt giữa các khóa riêng có nguồn gốc từ các ví cũ hơn hoặc mới hơn và tìm kiếm blockchain cho các giao dịch với các địa chỉ bitcoin tương ứng với các khóa công khai không nén hoặc tương ứng. Hãy xem cách hoạt động này chi tiết hơn, trong phần tiếp theo.</p>
<h5>Compressed Private keys</h5>
<p>Trớ trêu thay, tên "khóa riêng nén" là gây hiểu nhầm, bởi vì khi một khóa riêng được xuất dưới dạng WIF-nén, nó thực sự dài hơn một byte so với khóa riêng "không nén". Đó là bởi vì nó có thêm hậu tố 01 có nghĩa là nó xuất phát từ một ví mới hơn và chỉ nên được sử dụng để tạo ra các khóa public key nén. Khóa riêng không được nén và không thể nén. Thuật ngữ "khóa riêng nén" thực sự có nghĩa là "khóa riêng mà từ đó các khóa công cộng nén phải được bắt nguồn", trong khi "khóa riêng không nén" thực sự có nghĩa là "khóa riêng mà từ đó các khóa công khai không nén nên được bắt nguồn". Bạn chỉ nên tham khảo định dạng xuất dưới dạng “WIF-compressed” hoặc “WIF” và không tham chiếu đến khóa riêng tư dưới dạng “nén” để tránh nhầm lẫn hơn nữa.</p>
<p>Hãy nhớ rằng, các định dạng này không được sử dụng thay thế cho nhau. Trong một ví mới hơn mà thực hiện các khóa công khai nén, các khóa riêng sẽ chỉ được xuất như WIFcompressed (với tiền tố K hoặc L). Nếu ví là một triển khai cũ hơn và không sử dụng khóa công khai nén, các khóa riêng sẽ chỉ được xuất dưới dạng WIF (tiền tố 5). Mục tiêu ở đây là để báo hiệu cho ví nhập các khóa riêng tư này cho dù nó phải tìm kiếm blockchain cho các khóa và địa chỉ công cộng nén hoặc không nén. Nếu một ví bitcoin có thể thực hiện các khóa công khai nén, thì nó sẽ sử dụng các khóa đó trong tất cả các giao dịch. Các khóa riêng trong ví sẽ được sử dụng để lấy các điểm khóa công khai trên đường cong, sẽ được nén. Các khóa công khai nén sẽ được sử dụng để tạo ra các địa chỉ bitcoin và các địa chỉ đó sẽ được sử dụng trong các giao dịch. Khi xuất các khóa riêng tư từ một ví mới thực hiện các khóa công cộng nén, Định dạng nhập Wallet được sửa đổi, với việc bổ sung hậu tố một byte + 01 + vào khóa riêng. Khóa private được mã hóa base58check được gọi là "WIF nén" và bắt đầu bằng chữ cái K hoặc L, thay vì bắt đầu bằng chữ "5" như trường hợp với các khóa được mã hóa WIF (không được nén) từ các ví cũ hơn. Here’s the same key, encoded in WIF and WIF-compressed formats</p>
<img src="http://sv1.upsieutoc.com/2018/06/17/Screenshot-from-2018-06-17-16-22-26.png"/>
<h4>Implementing Keys and Addresses in Python</h4>
<p>Thư viện bitcoin toàn diện nhất trong Python là “pybitcointools” của Vitalik Buterin (https://github.com/vbuterin/pybitcointools) Trong ví dụ mã sau, chúng ta sử dụng thư viện pybitcointools (được nhập dưới dạng “bitcoin”) để tạo và hiển thị các khóa và địa chỉ ở các định dạng khác nhau:</p>
<img src="http://sv1.upsieutoc.com/2018/06/17/Screenshot-from-2018-06-17-16-36-18.png" />
<img src="http://sv1.upsieutoc.com/2018/06/17/Screenshot-from-2018-06-17-16-36-27.png" />
<img src="http://sv1.upsieutoc.com/2018/06/17/Screenshot-from-2018-06-17-16-38-35.png" />
<img src="http://sv1.upsieutoc.com/2018/06/17/Screenshot-from-2018-06-17-16-38-56.png" />
<img src="http://sv1.upsieutoc.com/2018/06/17/Screenshot-from-2018-06-17-16-40-20.png" />
<h4>Wallets</h4>
<p>Wallets là  các container cho khóa riêng, thường được triển khai dưới dạng tệp có cấu trúc hoặc cơ sở dữ liệu đơn giản. Một phương pháp khác để tạo khóa là tạo ra khóa xác định (deterministic key generation).Ở đây bạn lấy được mỗi khóa riêng mới, sử dụng hàm băm một chiều từ khóa riêng trước đó, liên kết chúng theo một chuỗi. Miễn là bạn có thể tạo lại chuỗi đó, bạn chỉ cần khóa đầu tiên (được gọi là khóa gốc (seed key)  hoặc khóa chính (master key) để tạo tất cả chúng. Trong phần này, chúng tôi sẽ xem xét các phương pháp khác nhau của tạo khóa và các cấu trúc ví được xây dựng xung quanh chúng.</p>
<i>Ví có chứa key, không phải coin. Các đồng tiền được lưu trữ trên blockchain trong các hình thức đầu ra giao dịch (thường được ghi nhận là vout hoặc txout). Mỗi người dùng có một ví chứa các key. Ví là các chuỗi khóa thực sự chứa các cặp khóa riêng / khóa công khai (Xem (đến)). Người dùng ký giao dịch với các khóa, qua đó chứng minh họ sở hữu các kết quả giao dịch (tiền của họ).</i>
